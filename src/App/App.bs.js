// Generated by ReScript, PLEASE EDIT WITH CARE
'use strict';

var Api = require("./Api.bs.js");
var Curry = require("rescript/lib/js/curry.js");
var React = require("react");
var $$Promise = require("@ryyppy/rescript-promise/src/Promise.bs.js");
var Caml_array = require("rescript/lib/js/caml_array.js");
var CountrySelect = require("./CountrySelect.bs.js");

function App(Props) {
  var match = React.useState(function () {
        return [];
      });
  var setCountrySelects = match[1];
  var countrySelects = match[0];
  var match$1 = React.useState(function () {
        return "";
      });
  var setError = match$1[1];
  React.useEffect((function () {
          $$Promise.$$catch(Api.Country.getCountries(undefined).then(function (result) {
                    var tmp;
                    if (result.TAG === /* Ok */0) {
                      var countries = result._0;
                      tmp = Curry._1(setCountrySelects, (function (_prev) {
                              return countries;
                            }));
                    } else {
                      var msg = result._0;
                      tmp = Curry._1(setError, (function (_prev) {
                              return "Could not query countries: " + msg;
                            }));
                    }
                    return Promise.resolve(tmp);
                  }), (function (e) {
                  if (e.RE_EXN_ID === Api.FailedRequest) {
                    var msg = e._1;
                    Curry._1(setError, (function (_prev) {
                            return "Operation failed! " + msg;
                          }));
                  } else {
                    Curry._1(setError, (function (_prev) {
                            return "Unknown error";
                          }));
                  }
                  return Promise.resolve(undefined);
                }));
          
        }), []);
  return React.createElement("div", undefined, countrySelects.length > 0 ? React.createElement(CountrySelect.make, {
                    value: Caml_array.get(countrySelects, 0),
                    options: countrySelects
                  }) : match$1[0]);
}

var make = App;

exports.make = make;
/* react Not a pure module */
